<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
     <mapper namespace="com.spring.magicMall.board.repository.IBoardMapper">
     
     	 <!-- db와 필드 매핑 -->
		<resultMap id="resultMap" type="com.spring.magicMall.board.model.BoardVO">
			<id property="postNo" column="post_no"/>
			<result property="userNo" column="user_no"/>
			<result property="title" column="title"/>
			<result property="content" column="content"/>
			<result property="picName" column="pic_name"/>
			<result property="postDate" column="post_date"/>
		</resultMap>
		
		
		<!-- 중복되는 동적SQL문에 대한 처리 -->
	<sql id = "search">
		<!-- 동적 sql 구문 -->
		<if test="condition == 'title'"> 
			WHERE title LIKE CONCAT('%',#{keyword},'%')
		</if>
	</sql>
		
		
		
		
		
		
		
		
		<!-- 게시물 등록 -->
		<insert id="insertContent">
			INSERT INTO magic_tip(user_no,title,content,pic_name)
			VALUES(#{userNo},#{title},#{content},#{picName});
		</insert>
		
		<!-- 게시물 여러개 가져오기 -->
		<select id="getArticleList" resultMap="resultMap">
			SELECT * 
			FROM magic_tip
			<include refid="search"/>
			ORDER BY post_no DESC
			LIMIT #{pageStart}, #{countPerPage}
		</select>
		
		<!-- 게시물 수 새기 -->
		<select id="countArticles" resultType="int">
			SELECT COUNT(*)
			FROM magic_tip
			<include refid="search"/>
		</select>
		
		<!-- 개별 게시물 가져오기 -->
		<select id="getOneArticle" resultMap="resultMap">
			SELECT * FROM magic_tip
			WHERE post_no = #{postNo};		
		</select>
		
		<!-- 게시물 수정하기 -->
		<update id="editArticle">
			UPDATE magic_tip 
			SET content = #{content}, pic_name = #{picName} , title=#{title}
			WHERE post_no =#{postNo};
		</update>
		
		<!-- 게시물 삭제하기 -->
		<delete id="delArticle">
			DELETE FROM magic_tip
			WHERE post_no =#{postNo};
		</delete>
     
     
     
     
     
     
     
     
     
     
     </mapper>